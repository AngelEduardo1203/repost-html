"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[2879],{73535:function(n,e,o){var t;o.d(e,{p:function(){return t},v:function(){return l}}),function(n){n.Normal="normal",n.OneHundredPercentOff="one_hundred_percent_off",n.SoldOut="sold_out",n.Ended="ended",n.Discontinue="discontinue"}(t||(t={}));var l=25},7929:function(n,e,o){var t;o.d(e,{N:function(){return t}}),function(n){n[n.OnSale=0]="OnSale",n[n.SoldOut=1]="SoldOut",n[n.NotFound=2]="NotFound"}(t||(t={}))},72879:function(n,e,o){o.r(e),o.d(e,{ComponentContext:function(){return O},ComponentProvider:function(){return G},createComponentStore:function(){return E},useComponentStore:function(){return k},useComponentStoreRef:function(){return C}});o(4256),o(17385),o(91211),o(70309),o(99492),o(91560),o(45483),o(12008);var t,l=o(88578),r=o(76635),i=o(35457),a=o(65362),u=o(97852),s=o(91373),d=o(77302);!function(n){n[n.FREE_GOODS=0]="FREE_GOODS",n[n.COMMON=1]="COMMON"}(t||(t={}));d.KT.SOURCE_DS_ID_SELECT,d.KT.SOURCE_DS_ID_SELECT,d.KT.INPUT,d.KT.JUMP_URL_SELECT,d.KT.RADIO_GROUP;var c=o(7929),f=o(990),p=o(73535),g=o(91570);o(60452),o(23395),o(44936);o(69460);function v(){return v=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(n[t]=o[t])}return n},v.apply(this,arguments)}function m(n,e,o,t){var l,r;void 0===n&&(n=[]),void 0===e&&(e=[]),void 0===o&&(o=[]);var i,a=null==o||null==(l=o.find((function(n){return(null==n?void 0:n.skuId)===t})))?void 0:l.specId,u=(o||[]).map((function(n){return{id:null==n?void 0:n.skuId,url:(null==n?void 0:n.imgUrl)||"",width:0,height:0}})),s=n.concat(u),d=null==(r=null!=(i=null==e?void 0:e.find((function(n){return a&&n.specId===a})))?i:null==e?void 0:e[0])?void 0:r.imageList,c=(null==e?void 0:e.length)?d:s;return null==c?void 0:c.map((function(n){return(null==n?void 0:n.width)&&(null==n?void 0:n.height)?n:v({},n,{needCrop:!0,width:480,height:639})}))}function I(n,e){(null==e||e>n.length)&&(e=n.length);for(var o=0,t=new Array(e);o<e;o++)t[o]=n[o];return t}function h(n,e,o,t,l,r,i){try{var a=n[r](i),u=a.value}catch(n){return void o(n)}a.done?e(u):Promise.resolve(u).then(t,l)}function D(n){return function(){var e=this,o=arguments;return new Promise((function(t,l){var r=n.apply(e,o);function i(n){h(r,t,l,i,a,"next",n)}function a(n){h(r,t,l,i,a,"throw",n)}i(void 0)}))}}function y(){return y=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(n[t]=o[t])}return n},y.apply(this,arguments)}function S(n){return function(n){if(Array.isArray(n))return I(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,e){if(!n)return;if("string"==typeof n)return I(n,e);var o=Object.prototype.toString.call(n).slice(8,-1);"Object"===o&&n.constructor&&(o=n.constructor.name);if("Map"===o||"Set"===o)return Array.from(o);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return I(n,e)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(n,e){var o,t,l,r,i={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;i;)try{if(o=1,t&&(l=2&r[0]?t.return:r[0]?t.throw||((l=t.return)&&l.call(t),0):t.next)&&!(l=l.call(t,r[1])).done)return l;switch(t=0,l&&(r=[2&r[0],l.value]),r[0]){case 0:case 1:l=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,t=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(l=i.trys,(l=l.length>0&&l[l.length-1])||6!==r[0]&&2!==r[0])){i=0;continue}if(3===r[0]&&(!l||r[1]>l[0]&&r[1]<l[3])){i.label=r[1];break}if(6===r[0]&&i.label<l[1]){i.label=l[1],l=r;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(r);break}l[2]&&i.ops.pop(),i.trys.pop();continue}r=e.call(n,i)}catch(n){r=[6,n],t=0}finally{o=l=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}var w=(0,g.fz)((function(n){var e={nodeCommon:{},context:{},$service:{},qrSSRData:{},jumpInfo:{},data:{},goodsDefaultPanel:p.p.Normal,listId:(0,i.x)(),bizExt:{},isFetchSuccess:!1,goods:{},cartScene:167,dataReady:!1,galleryImages:[],galleryIdx:0,galleryRatio:1,webpEnable:!1,showGoodsDetailDialog:!1,goodsId:0,isNormalStatus:!0,freeGoodsList:void 0,freeGoodsListTitle:"",showAppStoreDialog:!1,goodsInDialog:{},galleryIdxInDialog:0,galleryImagesInDialog:[],galleryRatioInDialog:1,goodsDataInDialog:{}};return(0,l.M)()((0,s.XR)((0,a.n)((function(o,l,a){return y({},e,n,{getInitialProps:D((function(n){var e,o,t,r,i,a;return b(this,(function(u){switch(u.label){case 0:return e=n.shareStore,o=l(),t=o.fetchData,r=o.dataReady,i=o.initBannerRatio,o.fetchQrData,a=o.fetchFreeGoodsList,r?[3,2]:[4,Promise.all([t(),a(),e.getState().fetchTips()])];case 1:u.sent(),i(),u.label=2;case 2:return[2]}}))})),fetchData:D((function(){var n,e,a,s,d,f,p,g,v,I,h,D,y,S,w,O,G,k,E,C,R,_,x,L,P,A,T,N,U,j,K,F;return b(this,(function(b){switch(b.label){case 0:return f=l(),p=f.$service,g=f.nodeCommon,v=f.setDefaultPanel,I=f.handleSpecChanged,[4,p.post({url:"api/jade/swiss/kp/ds",params:(0,u.lv)({dsId:(null==g||null==(n=g.props)?void 0:n.dsId)||"sg009",offset:0,limit:1,listId:(0,i.x)(6)},[],!0)})];case 1:return h=b.sent(),D=h.result||{},o({dataReady:!0,isFreePage:(null==g||null==(e=g.props)?void 0:e.pageType)!==(null==t?void 0:t.COMMON)}),(0,r.isEmpty)(null==D?void 0:D.kpDsItem)?(o({bizExt:(null==D?void 0:D.bizExt)||{}}),v(D),[2]):(y=(null==D?void 0:D.kpDsItem)||{},S=y.commonRecGoods,w=y.skuList,G=(O=S||{}).goodsId,k=O.skuId,E=O.skcList,C=O.status,R=O.priceInfo,x=(_=R||{}).appPromotionPrice,L=_.price,M=w||[],z=[],q={},(E||[]).forEach((function(n,e){var o=n.specId;q[o]||(q[o]=e)})),(M||[]).forEach((function(n){var e,o=n.spec,t=n.skuId,l=n.imgUrl,r=n.thumbUrl,i=n.priceInfo,a={};null==(e=o||[])||e.forEach((function(n){var e=n||{},o=e.specKey,u=e.specValue,s=e.specId,d=e.specKeyShowName,c=e.parentSpecId;a[o]=u;var f=z.find((function(n){return(null==n?void 0:n.type)===o})),p=(q[s],{skuId:t,specId:s,priceInfo:i,text:u,imgUrl:l||r});if(f){var g=f.valueIds,v=f.values;g.includes(s)||(g.push(s),v.push(p))}else{var m=[],I=[];m.push(s),I.push(p),z.push({type:o,specKeyShowName:d,specKeyId:c,valueIds:m,values:I})}}))})),P={skuTypeValue:null==z?void 0:z.find((function(n){return 1001==(null==n?void 0:n.specKeyId)}))},A=null==P||null==(a=P.skuTypeValue)?void 0:a.values,T=!!(null==E?void 0:E.length),N=k||(T?null==A||null==(s=A[0])?void 0:s.skuId:void 0),U=m(null==S?void 0:S.galleryImages,E,A,N),j=(null==D||null==(d=D.kpDsItemList)?void 0:d.map((function(n){return null==n?void 0:n.commonRecGoods})))||[],K=null!=x?x:L,F=l().isFreePage||0===K,o({data:D,goods:S||{},goodsId:G||0,formatSkuData:P,formatSkuList:A,hasSkc:T,galleryImages:U,isNormalStatus:C===c.N.OnSale,bizExt:(null==D?void 0:D.bizExt)||{},kpGoodsItemList:j,isFreePrice:F}),I(N),v(D),[2])}var M,z,q}))})),setDefaultPanel:function(n){var e,t,l,r,i,a;if(null==n||null==(e=n.bizExt)?void 0:e.freeGoodsDiscontinued)o({goodsDefaultPanel:p.p.Discontinue});else if((null==n||null==(t=n.kpDsItem)?void 0:t.commonRecGoods)&&(null==n||null==(r=n.kpDsItem)||null==(l=r.commonRecGoods)?void 0:l.title)){var u=null==n||null==(i=n.kpDsItem)?void 0:i.commonRecGoods,s=(null==u?void 0:u.status)===c.N.OnSale,d=!s&&!0===(null==u?void 0:u.discontinued);d||!s&&!d?o({goodsDefaultPanel:p.p.SoldOut}):(null==u||null==(a=u.priceInfo)?void 0:a.hitShowPriceLimit)&&o({goodsDefaultPanel:p.p.Ended})}else o({goodsDefaultPanel:p.p.OneHundredPercentOff})},initBannerRatio:function(){var n=l().galleryImages[0]||{},e=n.width,t=n.height;if(!e||!t)return 4/3;o({galleryRatio:t/e})},setGalleryIdx:function(n){void 0===n&&(n=0);var e=l(),t=e.galleryIdx,r=e.galleryImages;t===n||n<0||n>=r.length||o({galleryIdx:n})},toggleShowGoodsDetailDialog:function(){var n=l().showGoodsDetailDialog;o((function(e){e.showGoodsDetailDialog=!n}))},toggleShowAppStoreDialog:function(){var n=l().showAppStoreDialog;o((function(e){e.showAppStoreDialog=!n}))},fetchQrData:D((function(){var n,e,t,r,i,a,u;return b(this,(function(s){switch(s.label){case 0:return e=l(),t=e.nodeCommon,r=e.context,i=null==t||null==(n=t.props)?void 0:n.jumpInfo,a={req:null==r?void 0:r.__req,res:null==r?void 0:r.__res},[4,(0,f.q)({context:a,jumpUrl:null==i?void 0:i.jumpUrl})];case 1:return u=s.sent(),o((function(n){n.qrSSRData=u,n.jumpInfo=i})),[2]}}))})),fetchFreeGoodsList:D((function(){var n,e,t,r,a,s,d,c,f,g,v;return b(this,(function(m){switch(m.label){case 0:return r=l(),a=r.$service,s=r.nodeCommon,[4,a.post({url:"api/jade/swiss/kp/ds",params:(0,u.lv)({dsId:null!=(d=null==s||null==(n=s.props)?void 0:n.freeGoodsListDsId)?d:"g038",offset:0,limit:p.v,listId:(0,i.x)(6)},[],!0)})];case 1:return(null==(c=m.sent())||null==(t=c.result)||null==(e=t.kpDsItemList)?void 0:e.length)&&o({freeGoodsList:null==c||null==(g=c.result)||null==(f=g.kpDsItemList)?void 0:f.map((function(n){return y({},n,{data:n.commonRecGoods})})),freeGoodsListTitle:null==s||null==(v=s.props)?void 0:v.freeGoodsListTitle}),[2]}}))})),goodsCardClick:function(n){var e,t;if(!(0,r.isEmpty)(n)&&!(0,r.isEmpty)(null==n?void 0:n.commonRecGoods)){o((function(e){var o,t;e.goodsDataInDialog=n,e.goodsInDialog=null!=(t=null==n?void 0:n.commonRecGoods)?t:{},e.galleryImagesInDialog=S((null==n||null==(o=n.commonRecGoods)?void 0:o.galleryImages)||[])}));var i=(null==n||null==(t=n.commonRecGoods)||null==(e=t.galleryImages)?void 0:e[0])||{},a=i.width,u=i.height;a&&u&&(o((function(n){n.galleryRatioInDialog=u/a})),l().toggleShowGoodsDetailDialog())}},setGalleryIdxInDialog:function(n){void 0===n&&(n=0);var e,t=l(),r=t.galleryIdxInDialog,i=t.galleryImagesInDialog;r===n||n<0||n>=(null!=(e=null==i?void 0:i.length)?e:0)||o({galleryIdxInDialog:n})},resetGoodsInDialog:function(){o((function(n){n.goodsDataInDialog={},n.goodsInDialog={},n.galleryImagesInDialog=[],n.galleryRatioInDialog=1,n.galleryIdxInDialog=0}))},closeGoodsDetailDialog:function(){var n=l(),e=n.toggleShowGoodsDetailDialog;(0,n.resetGoodsInDialog)(),e()},handleSpecChanged:function(n){var e=l(),t=e.hasSkc,r=e.formatSkuList,i=e.setGalleryIdx,a=e.goods,u=e.galleryImages;(o({currentSelectSkuId:n,currentSelectSku:null==r?void 0:r.find((function(e){return(null==e?void 0:e.skuId)===n}))}),t)?(o({galleryImages:m([],null==a?void 0:a.skcList,r,n)}),i(0)):i((null==u?void 0:u.findIndex((function(e){return(null==e?void 0:e.id)===n})))||0)}})}))))})),O=w.ComponentContext,G=w.ComponentProvider,k=w.useComponentStore,E=w.createComponentStore,C=w.useComponentStoreRef}}]);
//# sourceMappingURL=http://temudebug.com/sourcemaps/assets/js/2879_b46d56e26660a1aba170.js.map